---
title: "[Kotlin] ViewPager2"
excerpt: "composeì—ì„œ ViewPager2ë¥¼ ì‚¬ìš©í•´ë³´ì."

writer: DaeYoungEE
categories:
  - Kotlin
tags:
  - [Kotlin, Compose, ViewPager2]
sidebar:
  nav: "counts"

data: 2024-01-25
last_modified_at: 2024-01-25

published: true
---

## ViewPager2

í•œ í™”ë©´ì—ì„œ ë‹¤ë¥¸ í™”ë©´ìœ¼ë¡œ ìŠ¬ë¼ì´ë“œí•´ì„œ ì „í™˜í•˜ê²Œ ë„ì™€ì£¼ëŠ” ê°ì²´ì´ë‹¤.
![viewPager](https://github.com/DaeYoungee/Compose_study/assets/121485300/3793ab1f-8a4e-44c2-a73c-d54fe911f18d)

## build.gradle.kts (module ìˆ˜ì¤€)

```kotlin
    // viewPager2
    implementation ("com.google.accompanist:accompanist-pager:0.20.1") // ìŠ¬ë¼ì´ë“œ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ë·°í˜ì´ì €
    implementation ("com.google.accompanist:accompanist-pager-indicators:0.20.1") // ë·° í˜ì´ì € ì¸ë””ì¼€ì´í„°, í•˜ë‹¨ì˜ ë™ê·¸ë¼ë¯¸
```

## HorizontalPager

`HorizontalPager`ì€ ìˆ˜í‰ ë°©í–¥ìœ¼ë¡œ ìŠ¬ë¼ì´ë“œë¥¼ ê°€ëŠ¥í•˜ê²Œ í•œë‹¤.

```kotlin
@Composable
fun PagerExample() {
    val state = rememberPagerState(initialPage = 0)
    val contentPadding = PaddingValues(50.dp)

    HorizontalPager(
        state = state,
        modifier = Modifier
            .weight(.7f)
            .padding(
                top = 32.dp, start = 16.dp, end = 16.dp
            )
            .background(color = Color.LightGray),
        count = 3,
        itemSpacing = 20.dp,
        contentPadding = contentPadding,
    ) {
        // pagerContent
    }
}
```

`HorizontalPager()` ì»´í¬ì €ë¸”ì— ê° í˜ì´ì§€ì˜ ìƒíƒœë¥¼ ì•Œ ìˆ˜ ìˆëŠ” `PagerState` ê°ì²´ë¥¼ ì¶”ê°€í•œë‹¤.

**Modifier.paddingê³¼ contentPaddingì˜ ì°¨ì´ë¥¼ ë§ì´ í—·ê°ˆë ¤í•œë‹¤. ê·¸ë¦¼ìœ¼ë¡œ ì•Œì•„ë³´ì.**

<div align="center">
<img alt="" src="https://github.com/DaeYoungee/Compose_study/assets/121485300/f88fe142-2b47-49c0-bed2-e76e9c79864f">   
</div>
ğŸ“Œ ì°¸ê³ ë¡œ contentëŠ” pageì™€ ê°™ì€ ì˜ë¯¸ì´ë‹¤. ì°¸ê³ í•˜ì

<br>

**itemSpacingëŠ” contentë“¤ ê°„ì˜ ê°„ê²©ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ê·¸ë¦¼ìœ¼ë¡œ ì•Œì•„ë³´ì.**  
â—ï¸ itemSpacing ê°’ì„ ìŒìˆ˜ë¡œ ì„¤ì •í•˜ë©´ ìœ„ì˜ ì‚¬ì§„ ì²˜ëŸ¼ contentë¼ë¦¬ ê²¹ì¹˜ê²Œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

<div align="center">
<img alt="" src="https://github.com/DaeYoungee/Compose_study/assets/121485300/a02ecffe-a274-4405-a99a-c9246279cadb">   
</div>
<br>

## contentì— í¬ê¸° ë° ê·¸ë¦¼ì ì„¤ì •

Card() ì»´í¬ì €ë¸”ì„ ì´ìš©í•´ì„œ contentì— ëª¨ì–‘, íˆ¬ëª…ë„, í¬ê¸°, ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ë¥¼ ì ìš©í•´ë³´ê² ë‹¤.

```kotlin
Card(
    Modifier
        .graphicsLayer {
            val pageOffset = calculateCurrentOffsetForPage(page).absoluteValue

            // We animate the scaleX + scaleY, between 85% and 100%
            lerp(
                0.85f,
                1f,
                1f - pageOffset.coerceIn(0f, 1f)
            ).also { scale ->
                scaleX = scale
                scaleY = scale
                Log.d(TAG,"page: ${page}\nfraction: ${pageOffset}\n scale: $scale")
            }

            // We animate the alpha, between 50% and 100%
            alpha = lerp(
                0.5f,
                1f,
                1f - pageOffset.coerceIn(0f, 1f)
            )
        }
    ) {
    Box(
        modifier = Modifier.fillMaxSize()
    ) {
        Text(text = page.toString(), modifier = Modifier.align(Alignment.Center))
    }
}
```

`graphicsLayer{}`ëŠ” ì• ë‹ˆë©”ì´ì…˜ì„ ì„¤ì •í•˜ëŠ” ë©”ì„œë“œ.  
`calculateCurrentOffsetForPage(page)`ëŠ” í˜„ì¬ í˜ì´ì§€ì˜ Offset ì •ë³´ë¥¼ ë°˜í™˜í•´ì£¼ê³  `.absoluteValue`ì„ í†µí•´ Offsetì„ ì ˆëŒ€ê°’ìœ¼ë¡œ ì„¤ì •í•œë‹¤.  
`lerp()`ì€ contentì˜ ì• ë‹ˆë©”ì´ì…˜ ì ìš©í•˜ëŠ” ë©”ì„œë“œì´ë‹¤. `also{}`ë¥¼ í†µí•´ í¬ê¸°ë¥¼ ì„¤ì •í•˜ê³  ìˆë‹¤.  
**scaleX**ì™€ **scaleY**ëŠ” widthì™€ heightë¥¼ ì„¤ì •í•˜ëŠ” í”„ë¡œí¼í‹°ì´ë‹¤. scaleì€ 0.85fì—ì„œ 1fê¹Œì§€ Offsetì˜ ê°’ì— ë”°ë¼ ë³€ê²½ëœë‹¤.  
`pageOffset.coerceIn(0f, 1f)`ì€ Offsetì˜ ê°’ì´ 0f ~ 1f ì‚¬ì´ì—ì„œë§Œ ì™”ë‹¤ê°”ë‹¤ í•˜ê²Œ ì„¤ì •í•˜ëŠ” ë©”ì„œë“œì´ë‹¤.

**alpha**ëŠ” íˆ¬ëª…ë„ë¥¼ ì„¤ì •í•˜ëŠ” í”„ë¡œí¼í‹°ì´ë‹¤.`lerp()`ë¥¼ í†µí•´ 0.5fì—ì„œ 1fê¹Œì§€ íˆ¬ëª…ë„ê°€ ì• ë‹ˆë©”ì´ì…˜ìœ¼ë¡œ ì ìš©ë˜ì–´ì§„ë‹¤.

<div align="center">
<img alt="" src="https://github.com/DaeYoungee/Compose_study/assets/121485300/b5795329-a321-4f96-a797-bfce0a982fcd">   
</div>
<br>
<div align="center">
<img alt="" src="https://github.com/DaeYoungee/Compose_study/assets/121485300/80da2782-f91b-4723-9262-d728b0936c0e">   
</div>
<br>

â—ï¸ì¦‰, `lerp()`ë©”ì„œë“œì˜ ë§¤ê°œë³€ìˆ˜ì¸ fractionì˜ ê°’ì„ ê³„ì‚°í•´ return ê°’ìœ¼ë¡œ í¬ê¸°ë¥¼ ë³€ê²½í•œë‹¤.  
ì˜ˆë¥¼ ë“¤ì–´ ì„¤ëª…í•˜ë©´ **pageOffset**ì´ 0fì¸ ê²½ìš°(contentê°€ ì¤‘ì•™ì— ìœ„ì¹˜í•œ ê²½ìš°) **fraction**ì˜ ê°’ì€ 1f, **return** ê°’ì€ 1f, ë”°ë¼ì„œ í¬ê¸°ê°€ ì›ë˜í¬ê¸°ì˜ 1f ë§Œí¼ì˜ í¬ê¸°ë¡œ ë°”ë€ë‹¤.  
**pageOffset**ì´ 1fì¸ ê²½ìš°(contentê°€ ì¤‘ì•™ì´ ì•„ë‹Œ ì˜†ì— ìœ„ì¹˜í•œ ê²½ìš°) **fraction**ì˜ ê°’ì€ 0f, **return** ê°’ì€ 0.85f, ë”°ë¼ì„œ í¬ê¸°ê°€ ì›ë˜í¬ê¸°ì˜ 0.85f ë§Œí¼ì˜ í¬ê¸°ë¡œ ë°”ë€ë‹¤.

## Offset, fraction ì´ê²Œ ë­”ë°?

ì•ì„œ ì„¤ëª…í•œ ì½”ë“œì— **Offset**, **fraction**ì´ ìì£¼ ë“±ì¥í–ˆë‹¤. ë§ì´ ê¶ê¸ˆí–ˆì„í…ë° ì§€ê¸ˆë¶€í„° ì•Œì•„ë³´ë ¤ê³  í•œë‹¤. **Offset**ê³¼ **fraction**ì€ ê°™ì€ ì˜ë¯¸ë¡œ ë³´ë©´ ëœë‹¤.  
**Offset**ì€ ë³´í†µ ìœ„ì¹˜ì˜ ì˜ë¯¸ë¡œ ë§ì´ ì“°ì´ê³  ViewPager2ì—ì„œ ë§ˆì°¬ê°€ì§€ë¡œ ìœ„ì¹˜ì˜ ì˜ë¯¸ë¡œ ì‚¬ìš©ë˜ì–´ì§„ë‹¤. ì•„ë˜ì˜
ì‚¬ì§„ì„ ë³´ì.

<img alt="" width="50%" src="https://github.com/DaeYoungee/Compose_study/assets/121485300/65324393-160d-4999-b797-02f0e5c95cd4"> ![image.jpg2](https://github.com/DaeYoungee/Compose_study/assets/121485300/a94b88de-496b-41a8-9124-a7bea7568265)
<br>

<img alt="" width="50%" src="https://github.com/DaeYoungee/Compose_study/assets/121485300/813dc4c2-b84e-4e19-92e7-9e9f2c3c3d42"> ![image.jpg2](https://github.com/DaeYoungee/Compose_study/assets/121485300/ead5f95a-2339-4f31-aa72-6be4cb66c084)

> â—ï¸ì¦‰, ì¤‘ì•™ì— ìˆëŠ” pageì˜ **fraction**ì€ 0, ê°€ì¥ìë¦¬ì— ìˆëŠ” pageì˜ **fraction**ì€ 1ì´ë‹¤. ì¤‘ì•™ì—ì„œ ê°€ì¥ìë¦¬ë¡œ ì´ë™ë  ë•Œ **fraction**ì€ ì¦ê°€ëœë‹¤.  
> ì¤‘ì•™ì— ìˆëŠ” pageë¡œë¶€í„° ë–¨ì–´ì ¸ìˆì„ ë•Œ fractionëŠ” page 1ê°œë‹¹ 1ì”© ì¦ê°€ëœë‹¤.  
> [fraction ê´€ë ¨ ì´í•´ë¥¼ ë„ìš¸ ìˆ˜ ìˆëŠ” ë§í¬](https://www.sinasamaki.com/pager-animations/)

## í˜ì´ì§€ ë³€ê²½ì— ë°˜ì‘

`PagerState.currentPage`ëŠ” pageê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ ì†ì„±ì´ ì—…ë°ì´íŠ¸ëœë‹¤. `snapshotFlow` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ íë¦„ì˜ ë³€ê²½ ì‚¬í•­ì„ ê´€ì°°í•  ìˆ˜ ìˆë‹¤.

```kotlin
LaunchedEffect(state) {
    snapshotFlow { state.currentPage }.collect { page ->
            Log.d(TAG, "page: $page")
    }
}
```

## Indicator

**Indicator**ë¥¼ í†µí•´ í˜ì´ì§€ì˜ ìœ„ì¹˜ë¥¼ ë‚˜íƒ€ë‚´ì–´ ì‚¬ìš©ìì˜ ë§Œì¡±ë„ë¥¼ ë†’ì¼ ìˆ˜ ìˆë‹¤. í˜ì´ì§€ê°€ ì–¼ë§Œí¼ ë‚¨ì•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆê¸°ì— í¸ë¦¬í•˜ë‹¤. ViewPager ë°‘ì— ìˆëŠ” ì‘ì€ ë™ê·¸ë¼ë¯¸ ì—¬ëŸ¬ê°œê°€ **Indicator**ì´ë‹¤. ì•„ë˜ì˜ ì‚¬ì§„ìœ¼ë¡œ ì‚´í´ë³´ì.

<div align="center">
<img alt="" src="https://github.com/DaeYoungee/Compose_study/assets/121485300/004b44fd-c4f2-441d-b5e3-a731826a4e57">   
</div>
<br>

í˜„ì¬ í˜ì´ì§€ì˜ ìƒíƒœë¥¼ ì•Œê¸° ìœ„í•œ **pagerState**ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë„£ì–´ì¤€ë‹¤. **activeColor**ëŠ” Indicatorì˜ ë™ê·¸ë¼ë¯¸ ìƒì‚­ì„ ë³€ê²½í•  ìˆ˜ ìˆê²Œ ë„ì™€ì¤€ë‹¤.

```kotlin
HorizontalPagerIndicator(pagerState = state, activeColor = Color.Blue)
```

## ì „ì²´ ì½”ë“œ

```kotlin
@Composable
fun ViewPagerExample() {
    val state = rememberPagerState(initialPage = 0)
    val contentPadding = PaddingValues(50.dp)

    LaunchedEffect(state) {
        // Collect from the pager state a snapshotFlow reading the currentPage
        snapshotFlow { state.currentPage }.collect { page ->
             Log.d(TAG, "page: $page")
        }
    }

    Column(
        modifier = Modifier.fillMaxSize(),
        verticalArrangement = Arrangement.Center,
        horizontalAlignment = Alignment.CenterHorizontally
    ) {
        HorizontalPager(
            state = state,
            modifier = Modifier
                .weight(.7f)
                .padding(
                    top = 32.dp, start = 16.dp, end = 16.dp
                )
                .background(color = Color.LightGray),
            count = 3,
            itemSpacing = (-70).dp,
            contentPadding = contentPadding,
        ) {page ->
            Card(
                Modifier
                    .graphicsLayer {

                        val pageOffset = calculateCurrentOffsetForPage(page).absoluteValue
//                        val pageOffset = calculateCurrentOffsetForPage(page)

                        // We animate the scaleX + scaleY, between 85% and 100%
                        lerp(
                            0.85f,
                            1f,
                            1f - pageOffset.coerceIn(0f, 1f)
                        ).also { scale ->
                            scaleX = scale
                            scaleY = scale
                            Log.d(TAG,"page: ${page}\nfraction: ${pageOffset}\n scale: $scale")
                        }

                        // We animate the alpha, between 50% and 100%
                        alpha = lerp(
                            0.5f,
                            1f,
                            1f - pageOffset.coerceIn(0f, 1f)
                        )
                    }
            ) {
                Box(
                    modifier = Modifier.fillMaxSize()
                ) {
                    Text(text = page.toString(), modifier = Modifier.align(Alignment.Center))
                }
            }

        }
        Spacer(modifier = Modifier.height(16.dp))
        HorizontalPagerIndicator(pagerState = state, activeColor = Color.Blue)
    }
}

```

## Reference

[ì´í•´í•˜ê¸° ì‰¬ìš´ viewpager ë¸”ë¡œê·¸](https://google.github.io/accompanist/pager/)  
[compose viewpager](https://velog.io/@dldmswo1209/Compose-UI-Pager)  
[custom Indicator ë¼ì´ë¸ŒëŸ¬ë¦¬](https://github.com/tommybuonomo/dotsindicator)  
[ì§ì ‘ customí•˜ëŠ” Indicator](https://blog.canopas.com/jetpack-compose-how-to-implement-custom-pager-indicators-8b6a01d63964)
