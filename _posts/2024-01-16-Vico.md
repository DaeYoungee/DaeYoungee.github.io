---
title: "[Kotlin] Vico ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•´ì„œ ê·¸ë˜í”„ êµ¬í˜„"
excerpt: "Koltin Jetpack Composeì—ì„œ ê·¸ë˜í”„ë¥¼ ì‚¬ìš©í•´ë³´ì."

writer: DaeYoungEE
categories:
  - Kotlin
tags:
  - [Kotlin, Vico]
sidebar:
  nav: "counts"

data: 2024-01-16
last_modified_at: 2024-01-16

published: true
---

## Vicoë€?

Koltin Jetpack Composeì—ì„œëŠ” ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ê¸° ìœ„í•´ ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ëŠ” ì»´í¬ì €ë¸” í•¨ìˆ˜ë¥¼ ì°¾ì•˜ì§€ë§Œ ì°¾ì„ ìˆ˜ ì—†ì—ˆë‹¤. ê·¸ë˜ì„œ ë°œê²¬í•˜ê²Œ ëœ ë¼ì´ë¸Œë¦¬ë¦¬ê°€ <span style="color:rgb(77,171,254)"> **Vico** </span>ì´ë‹¤.

> **Vico** ë¼ì´ë¸ŒëŸ¬ë¦¬ë€ Koltin Jetpack Composeì—ì„œ í†µê³„ë¥¼ ë‚´ëŠ” ê²½ìš° í•œ ëˆˆì— ë³´ê¸° í¸í•˜ê²Œ **ì°¨íŠ¸**ë¡œ ë³´ì—¬ì¤„ ìˆ˜ ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤.

## Vico ì¢…ì†ì„ ìœ„í•œ í•„ìˆ˜ ì„¤ì •

ë‚˜ëŠ” ì•„ë¬´ê²ƒë„ ëª¨ë¥´ê³  vico ê³µì‹ í™ˆí˜ì´ì§€ì— ë“¤ì–´ê°€ ì¢…ì†ì„±ì„ ì¶”ê°€í•˜ê³  sync í–ˆì§€ë§Œ ì˜¤ë¥˜ê°€ ë‚¬ë‹¤. ìì„¸í•œ ì›ì¸ì„ ì•Œì•„ë³´ë ¤ê³  êµ¬ê¸€ë§ì„ ëª‡ ì‹œê°„ ë™ì•ˆí•œ ëì— ì´ìœ ë¥¼ ì•Œì•˜ë‹¤. **ì´ìœ ëŠ” targetSdkì˜€ë‹¤.** ì§€ê¸ˆê¹Œì§€ ë‚˜ëŠ” targetSdkê°€ 33ì¸ í™˜ê²½ì—ì„œ ì•ˆë“œë¡œì´ë“œìŠ¤íŠœë””ì˜¤ë¥¼ ì‹¤í–‰í–ˆë˜ ê²ƒì´ë‹¤.

### TargetSdk ì„¤ì •

- build.gradle.kts(Module ìˆ˜ì¤€)
  ```kotlin
  android {
    defaultConfig {
      ..
      targetSdk = 34 // ìµœì†Œ 34ì´ìƒ
      ..
    }
  }
  ```

## ë‘ ë²ˆì§¸ ë¬¸ì œ ë°œìƒ

targetSdkë¥¼ 33 -> 34ë¡œ ë°”ê¾¸ì„œ syncë¥¼ í–ˆì§€ë§Œ ë˜ ì˜¤ë¥˜ê°€ ë‚¬ë‹¤. ìˆœê°„ ìš•ì´ ë‚˜ì™”ì§€ë§Œ ë‹¤ì‹œ í•œë²ˆ ì˜¤ë¥˜ ì›ì¸ì„ ì•Œì•„ë³´ê¸° ìœ„í•´ êµ¬ê¸€ë§ì„ í–ˆë‹¤. ê·¸ ê²°ê³¼ ì½”í‹€ë¦° ë²„ì „ë§ˆë‹¤ ì§€ì›í•˜ëŠ” targetSdk ë ˆë²¨ì´ ë‹¬ëë‹¤. ì¦‰ ë‚˜ëŠ” ì½”í‹€ë¦° ë²„ì „ì„ ë°”ê¾¸ë ¤ê³  í–ˆê³  ê·¸ ê³¼ì •ì†ì— ì•ˆë“œë¡œì´ë“œ ìŠ¤íŠœë””ì˜¤ì˜ ë²„ì „ë„ ë°”ê¿¨ë‹¤.

> AndroidStudio Hedgehogìœ¼ë¡œ ë²„ì „ì„ ë°”ê¿¨ë‹¤.  
> [ê³µì‹ í™ˆí˜ì´ì§€ AndroidStudio ë²„ì „](https://developer.android.com/studio/releases?hl=ko)

ì•„ë˜ì˜ ì‚¬ì§„ì„ ë³´ë©´ AndroidStudio ë²„ì „ë§ˆë‹¤ API ìˆ˜ì¤€ì´ ë‹¤ë¥¸ê±¸ ì•Œ ìˆ˜ ìˆë‹¤.

<div align="center">
<img alt="snackbarHostState" src="https://github.com/DaeYoungee/Compose_study/assets/121485300/094b48ea-e519-4e2b-899d-dc157d422f99">   
</div>

ì•„ë˜ëŠ” targetSdkê°€ 34ì´ê¸° ìœ„í•œ ì½”í‹€ë¦° ë²„ì „ì´ë‹¤. **"1.9.0"**ìœ¼ë¡œ ì„¤ì •í–ˆë‹¤.

- build.gradle.kts(App ìˆ˜ì¤€)
  ```kotlin
  plugins {
    id("com.android.application") version "8.2.1" apply false
    id("org.jetbrains.kotlin.android") version "1.9.0" apply false
    id("com.google.devtools.ksp") version "1.9.0-1.0.12" apply false
  }
  ```

## Vico ì¢…ì†ì„± ì¶”ê°€

- build.gradle.kts(Module ìˆ˜ì¤€)
  ```kotlin
  // vico
  implementation("com.patrykandpatrick.vico:compose:2.0.0-alpha.6") // For Jetpack Compose.
  implementation("com.patrykandpatrick.vico:compose-m3:2.0.0-alpha.6") // For `compose`. Creates a `ChartStyle` based on an M3 Material Theme.
  ```

## CartesianChartHost

ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ê¸° ìœ„í•´ ê°€ì¥ ê¸°ë³¸ì´ ë˜ëŠ” ì»´í¬ì €ë¸” í•¨ìˆ˜ì´ë‹¤. `CartesianChartHost`ì˜ ê°€ì¥ ì¤‘ìš”í•œ ë§¤ê°œë³€ìˆ˜ëŠ” chartì™€ modelProducerì´ë‹¤.

```kotlin
CartesianChartHost(
    chart = rememberCartesianChart(...),
    modelProducer = ...,
    marker = ...,
    isZoomEnabled = false,
    horizontalLayout = HorizontalLayout.fullWidth()
)
```

ğŸ“Œ ê³µë¶€í•˜ë©´ì„œ ì•Œê²Œëœ ì‚¬ì‹¤ì„ ì´í•´í•˜ê¸° ì‰½ê²Œ ê°„ë‹¨í•˜ê²Œ ì„¤ëª…í•˜ë ¤ê³  í•œë‹¤.  
`model`: ê·¸ë˜í”„ì˜ ìˆ˜ì¹˜ë¥¼ í‘œí˜„ì„ ìœ„í•œ ì•„ë˜ì˜ xì¶•ê³¼ yì¶•ì„ ì˜ë¯¸  
`modelProducer`: ë°ì´í„°ë¥¼ ë„£ìœ¼ë©´ ì°¨íŠ¸ ëª¨ë¸ì„ ë§Œë“¤ì–´ ì¤€ë‹¤.(ë‹¹ì—°íˆ ë™ì ìœ¼ë¡œ ë³€ê²½ ê°€ëŠ¥í•˜ë‹¤.)  
`marker`: í™”ë©´ì„ í„°ì¹˜í•˜ê±°ë‚˜ í™”ë©´ì„ ëˆ„ë¥´ê³  ìˆì„ ë•Œ í•´ë‹¹ xì¢Œí‘œì˜ markerë¥¼ ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì¤€ë‹¤.  
`isZoomEnabled`: ì°¨íŠ¸ì˜ í™•ëŒ€ ê°€ëŠ¥ ì—¬ë¶€ë¥¼ ì„¤ì •í•˜ëŠ” ë§¤ê°œë³€ìˆ˜  
`horizontalLayout`: ì°¨íŠ¸ê°€ xì¢Œí‘œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì–¼ë§ˆí¼ì˜ ê°€ë¡œ ê¸¸ì´ë¥¼ ê°–ëŠ”ì§€ì— ëŒ€í•œ ì„¤ì •ì´ë‹¤.

<br>

<div align="center">
<img alt="snackbarHostState" src="https://github.com/DaeYoungee/Compose_study/assets/121485300/3eb0f015-5744-411f-90e4-9700178c33db">   
</div>
<br>
<div align="center">
<img alt="snackbarHostState" src="https://github.com/DaeYoungee/Compose_study/assets/121485300/d0320aad-b2a3-4156-a7f1-297f507b44d1">   
</div>

`HorizontalLayout.segmented()` ëŠ” ë””í´íŠ¸ ê°’ì´ë‹¤. ì°¨íŠ¸ë¥¼ xì¢Œí‘œì— ê°€ë“ ì±„ìš°ê³  ì‹¶ìœ¼ë©´ ë³„ë„ë¡œ `HorizontalLayout.fullWidth()`ë¥¼ ì„¤ì •í•´ì•¼ í•œë‹¤.

## rememberCartesianChartart

`rememberCartesianChart()` ì»´í¬ì €ë¸” í•¨ìˆ˜ëŠ” ì•ì—ì„œ ì„¤ëª…í–ˆë˜ `CartesianChartHost` ì»´í¬ì €ë¸” í•¨ìˆ˜ì˜ chart ë§¤ê°œë³€ìˆ˜ì— ì‚¬ìš©ëœë‹¤. ì•„ë˜ì˜ ì½”ë“œë¥¼ ì‚´í´ë³´ì.

```kotlin
private const val AXIS_VALUE_OVERRIDER_Y_FRACTION = 1f

private val axisValueOverrider =
    AxisValueOverrider.adaptiveYValues<LineCartesianLayerModel>(
        yFraction = AXIS_VALUE_OVERRIDER_Y_FRACTION,
        round = false,  // ë°˜ì˜¬ë¦¼
    )

CartesianChartHost(
    chart = rememberCartesianChart(
        rememberLineCartesianLayer(axisValueOverrider = axisValueOverrider),
        startAxis = rememberStartAxis(guideline = null),
        bottomAxis = rememberBottomAxis(
            guideline = null,
            itemPlacer = AxisItemPlacer.Horizontal.default(),
        ),
        persistentMarkers = remember(marker) { mapOf(2.0f to marker) },
        fadingEdges = rememberFadingEdges(),
        legend = rememberLegend()
    )
)
```

- rememberCartesianChartart() ë§¤ê°œë³€ìˆ˜ ì„¤ëª…  
   `startAxis`ëŠ” yì¶• ì¢Œí‘œì´ë©°, ì¢Œì¸¡ í•˜ë‹¨ì—ì„œ ì‹œì‘í•œë‹¤.  
   `bottomAxis`ëŠ” xì¶• ì¢Œí‘œì´ë©°, ì¢Œì¸¡ í•˜ë‹¨ì—ì„œ ì‹œì‘í•œë‹¤.  
   `persistentMarkers`ì€ í•´ë‹¹ xì¢Œí‘œì˜ yì— ì§€ì†ì ì¸ markerë¥¼ í‘œì‹œí•˜ëŠ” ë§¤ê°œë³€ìˆ˜, (ì½”ë“œì—ì„œëŠ” 2.0f ì¸ x ì¢Œí‘œì— markerë¥¼ ì°ì–´ì¤Œ.)  
   `fadingEdges`ì€ íŠ¹ì • ê°€ì¥ìë¦¬ ë„ˆë¨¸ì— ë” ë§ì€ ì½˜í…ì¸ ê°€ ìˆìœ¼ë©° ì‚¬ìš©ìê°€ ìŠ¤í¬ë¡¤í•˜ì—¬ ì´ë¥¼ ë“œëŸ¬ë‚¼ ìˆ˜ ìˆìŒì„ ì•Œë ¤ì¤€ë‹¤.  
   `legend`ì€ ì°¨íŠ¸ì— ëŒ€í•´ ë¶€ê°€ì ì¸ ì„¤ëª…ì„ Stringìœ¼ë¡œ ë‚˜íƒ€ë‚¸ë‹¤.

    <br> 
    <div align="center">
    <img alt="snackbarHostState" src="https://github.com/DaeYoungee/Compose_study/assets/121485300/a1e05d51-bb7c-4871-b7d2-c9121295333f">   
    </div>
    xì¶• ì¢Œí‘œì˜ 8ë²ˆì§¸ ë°ì´í„° ë¶€í„° ì°¨íŠ¸ê°€ íë¦¿í•´ì§€ëŠ” ë³¼ ìˆ˜ ìˆëŠ”ë° ì´ê±¸ fade íš¨ê³¼ë¼ê³  í•˜ê³  scrollí•´ì„œ ë‹¤ìŒ ë°ì´í„°ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŒì„ ì•Œë ¤ì¤€ë‹¤.

  <br>

- rememberStartAxis()ì˜ guideline ë§¤ê°œë³€ìˆ˜  
 `rememberStartAxis()`ì˜ guidelineì€ yì¶•ì˜ ëª¨ë“  ì¢Œí‘œê°€ ì ì„ ìœ¼ë¡œ ì—°ê²°ë˜ì–´ ë°ì´í„°ë¥¼ ë³´ê¸° í¸í•˜ê²Œ ë‚˜íƒ€ë‚¸ê²ƒì´ë‹¤. `rememberBottomAxis()`ì˜ guidelineê¹Œì§€ ì„¤ì • í•˜ë©´ xì¶•ì˜ ëª¨ë“  ì¢Œí‘œì™€ yì¶•ì˜ ëª¨ë“  ì¢Œí‘œê°€ ì ì„¬ìœ¼ë¡œ ì—°ê²°ë˜ì–´ì§„ë‹¤. ê·¸ë¦¼ìœ¼ë¡œ ë³´ë©´ í¸í•  ê²ƒì´ë‹¤. `rememberStartAxis()`ì™€ `rememberBottomAxis()`ì—ëŠ” ë””í´íŠ¸ ê°’ìœ¼ë¡œ `guideline = axisGuidelineComponent()`ì´ ì„¤ì •ë˜ì–´ ìˆì–´ ë”°ë¡œ guidelineì„ ì„¤ì •í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.
  <div align="center">
  <img alt="snackbarHostState" src="https://github.com/DaeYoungee/Compose_study/assets/121485300/45ff0d65-9b9c-415c-8e0d-06efc2602123">   
  </div>
<br>

- rememberBottomAxis()ì˜ itemPlacer ë§¤ê°œë³€ìˆ˜  
itemPlacerì€ xì¶•ì˜ ë°ì´í„°ê°„ì˜ ê³µê°„ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ì•„ë˜ì˜ ê·¸ë¦¼ìœ¼ë¡œ ì´í•´í•´ë³´ì. ë”°ë¡œ itemPlacerë¥¼ ì„¤ì •í•˜ì§€ ì•Šì•„ë„ ê¸°ë³¸ì ìœ¼ë¡œ `itemPlacer = AxisItemPlacer.Horizontal.default()` ë¡œ ì ìš©ë˜ì–´ ìˆë‹¤.
  <div align="center">
  <img alt="snackbarHostState" src="https://github.com/DaeYoungee/Compose_study/assets/121485300/6cb82748-f71f-4cd5-b36b-284190e7058b">   
  </div>
<br>

- rememberLineCartesianLayer()  
   yì¶• ì¢Œí‘œì— ìµœëŒ€ì™€ ìµœì†Œ, xì¶• ì¢Œí‘œì˜ ìµœëŒ€ì™€ ìµœì†Œ ê°’ì„ ì„¤ì •í•  ìˆ˜ ìˆê³  ë™ì ìœ¼ë¡œ yì¶• ì¢Œí‘œì˜ ê°’ì„ ë³€ê²½ í•  ìˆ˜ ìˆë‹¤.  
   `AxisValueOverrider.adaptiveYValues()`: ë™ì ìœ¼ë¡œ yì¶• ì¢Œí‘œì˜ ê°’ì„ ë³€ê²½
  `AxisValueOverrider.fixed()`: ê³ ì •ì ìœ¼ë¡œ yì¶• ì¢Œí‘œì— ìµœëŒ€ì™€ ìµœì†Œ, xì¶• ì¢Œí‘œì˜ ìµœëŒ€ì™€ ìµœì†Œ ê°’ì„ ì„¤ì •

  - AxisValueOverrider.adaptiveYValues()ì˜ ë§¤ê°œë³€ìˆ˜  
     `yFraction`: yì¢Œí‘œì¤‘ ìµœëŒ€ê°’ì˜ ë°°ìˆ˜ ë§Œí¼ yì¢Œí‘œì˜ ìµœëŒ€ê°’ì„ ì„¤ì • ex) yì¢Œí‘œì¤‘ ìµœëŒ€ê°’ì´ 9.2ì¸ ê²½ìš° yì¶• ì¢Œí‘œëŠ” 18.4ì˜ í¬ê¸°ê¹Œì§€ ë§Œë“¤ì–´ ì§„ë‹¤.  
     `round`: yì¢Œí‘œì˜ ìµœëŒ€ê°’ê³¼ ìµœì†Œê°’ì„ ë°˜ì˜¬ë¦¼ ì—¬ë¶€ ì„¤ì •
    <div align="center">
    <img alt="snackbarHostState" src="https://github.com/DaeYoungee/Compose_study/assets/121485300/80c1606c-f339-420b-9e6f-aa58d1290777">  
     </div>
    <br>

- legend  
  ì°¨íŠ¸ì˜ ë¶€ê°€ì ì¸ ì„¤ëª…ì„ ë„ì™€ì£¼ëŠ” Textë¼ê³  ìƒê°í•˜ë©´ëœë‹¤. ì•„ë˜ì˜ ì‚¬ì§„ì„ ë³´ê³  ì´í•´í•˜ì.
    <div align="center">
    <img alt="legend" src="https://github.com/DaeYoungee/Compose_study/assets/121485300/20270bda-0a57-49bc-91d7-1dbe8396335a">   
    </div>
  <br>

## CartesianChartModelProducer

ì´ë¦„ì—ì„œ ì•Œ ìˆ˜ ìˆë“¯ì´ `CartesianChartModelProducer` ëŠ” `CartesianChartHost()` ì»´í¬ì €ë¸” í•¨ìˆ˜ì˜ modelProducer ë§¤ê°œë³€ìˆ˜ì— ì“°ì¸ë‹¤. ë§ ê·¸ëŒ€ë¡œ modelì„ ìƒì‚°í•œë‹¤. ì•„ë˜ì˜ ì½”ë“œë¥¼ ì‚´í´ë³´ì.

- VicoViewModel.kt

  ```kotlin
  class VicoViewModel @Inject constructor() : ViewModel() {
      private val modelProducer = CartesianChartModelProducer.build()

      private var _list = mutableStateListOf<Double>(1.0, 9.2, 3.3, 7.8)
      val list: List<Double> = _list

      init {
          changeSeries()
      }

      fun changeSeries() {
          modelProducer.tryRunTransaction {
              lineSeries {
                  series(y = list)
              }
          }
      }

      fun setList(list: List<Double>) {
          _list.clear()
          list.forEach {
              _list.add(it)
          }
          changeSeries()
      }

      fun getModelProducer() = modelProducer

  }
  ```

  `CartesianChartModelProducer.build()` ì½”ë“œë¡œ **modelProducer**ë¥¼ ë§Œë“¤ê³  `tryRunTransaction{}`ì„ í†µí•´ ë°ì´í„°ë¥¼ ë„£ì–´ì¤€ë‹¤. ë³¸ í¬ìŠ¤íŒ…ì—ì„œëŠ” **LineChart**ë¥¼ ì‚¬ìš©í•˜ê¸° ë–„ë¬¸ì— `lineSeries{}`ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì‚½ì…í–ˆë‹¤.  
  ViewModelì´ ìƒì„±ë  ë‹¹ì‹œ `changeSeries()` ë©”ì„œë“œ í˜¸ì¶œì„ í†µí•´ ì°¨íŠ¸ì— ë°ì´í„°ë¥¼ ë„£ì–´ì¤¬ê³  ì°¨íŠ¸ ìˆ˜ì •ì´ í•„ìš”í•  ë•Œë§ˆë‹¤ `setList()`ë¥¼ í˜¸ì¶œí•¨ìœ¼ë¡œì¨ ì°¨íŠ¸ ìˆ˜ì •ë° UIì— ë°˜ì˜ì´ ë˜ê²Œ í–ˆë‹¤.

## Marker

MarkerëŠ” í™”ë©´ì„ í„°ì¹˜í•˜ê±°ë‚˜ ëˆ„ë¥´ê³  ìˆì„ ë•Œ, í•´ë‹¹ xì¢Œí‘œì˜ y ê°’ì„ í‘œì‹œí•˜ëŠ” ì»´í¬ì €ë¸” í•¨ìˆ˜ì´ë‹¤.  
í•„ì ë˜í•œ gitì— ìˆëŠ” ì½”ë“œë¥¼ Ctrl + C, Ctrl + V í–ˆê¸° ë•Œë¬¸ì— ì½”ë“œ ì„¤ëª…ì„ ìƒëµí•˜ê² ë‹¤.

```kotlin
@Composable
internal fun rememberMarker(): Marker {
    val labelBackgroundColor = MaterialTheme.colorScheme.surface
    val labelBackground =
        remember(labelBackgroundColor) {
            ShapeComponent(labelBackgroundShape, labelBackgroundColor.toArgb()).setShadow(
                radius = LABEL_BACKGROUND_SHADOW_RADIUS,
                dy = LABEL_BACKGROUND_SHADOW_DY,
                applyElevationOverlay = true,
            )
        }
    val label =
        rememberTextComponent(
            background = labelBackground,
            lineCount = LABEL_LINE_COUNT,
            padding = labelPadding,
            typeface = Typeface.MONOSPACE,
        )
    val indicatorInnerComponent = rememberShapeComponent(Shapes.pillShape, MaterialTheme.colorScheme.surface)
    val indicatorCenterComponent = rememberShapeComponent(Shapes.pillShape, Color.White)
    val indicatorOuterComponent = rememberShapeComponent(Shapes.pillShape, Color.White)
    val indicator =
        overlayingComponent(
            outer = indicatorOuterComponent,
            inner =
            overlayingComponent(
                outer = indicatorCenterComponent,
                inner = indicatorInnerComponent,
                innerPaddingAll = indicatorInnerAndCenterComponentPaddingValue,
            ),
            innerPaddingAll = indicatorCenterAndOuterComponentPaddingValue,
        )
    val guideline =
        rememberLineComponent(
            MaterialTheme.colorScheme.onSurface.copy(GUIDELINE_ALPHA),
            guidelineThickness,
            guidelineShape,
        )
    return remember(label, indicator, guideline) {
        object : MarkerComponent(label, indicator, guideline) {
            init {
                indicatorSizeDp = INDICATOR_SIZE_DP
                onApplyEntryColor = { entryColor ->
                    indicatorOuterComponent.color = entryColor.copyColor(INDICATOR_OUTER_COMPONENT_ALPHA)
                    with(indicatorCenterComponent) {
                        color = entryColor
                        setShadow(radius = INDICATOR_CENTER_COMPONENT_SHADOW_RADIUS, color = entryColor)
                    }
                }
            }

            override fun getInsets(
                context: MeasureContext,
                outInsets: Insets,
                horizontalDimensions: HorizontalDimensions,
            ) = with(context) {
                outInsets.top = label.getHeight(context) + labelBackgroundShape.tickSizeDp.pixels +
                        LABEL_BACKGROUND_SHADOW_RADIUS.pixels * SHADOW_RADIUS_MULTIPLIER -
                        LABEL_BACKGROUND_SHADOW_DY.pixels
            }
        }
    }
}

private const val LABEL_BACKGROUND_SHADOW_RADIUS = 4f
private const val LABEL_BACKGROUND_SHADOW_DY = 2f
private const val LABEL_LINE_COUNT = 1
private const val GUIDELINE_ALPHA = .2f
private const val INDICATOR_SIZE_DP = 36f
private const val INDICATOR_OUTER_COMPONENT_ALPHA = 32
private const val INDICATOR_CENTER_COMPONENT_SHADOW_RADIUS = 12f
private const val GUIDELINE_DASH_LENGTH_DP = 8f
private const val GUIDELINE_GAP_LENGTH_DP = 4f
private const val SHADOW_RADIUS_MULTIPLIER = 1.3f

private val labelBackgroundShape = MarkerCorneredShape(Corner.FullyRounded)
private val labelHorizontalPaddingValue = 8.dp
private val labelVerticalPaddingValue = 4.dp
private val labelPadding = dimensionsOf(labelHorizontalPaddingValue, labelVerticalPaddingValue)
private val indicatorInnerAndCenterComponentPaddingValue = 5.dp
private val indicatorCenterAndOuterComponentPaddingValue = 10.dp
private val guidelineThickness = 2.dp
private val guidelineShape = DashedShape(Shapes.pillShape, GUIDELINE_DASH_LENGTH_DP, GUIDELINE_GAP_LENGTH_DP)
```

## ProvideChartStyle

ProvideChartStyleì„ ì´ìš©í•´ ì°¨íŠ¸ ìŠ¤íƒ€ì¼ì„ ì ìš©í•´ ì£¼ì—ˆë‹¤.  
ProvideChartStyle() ì•ˆì— ìì‹ ì´ ë§Œë“  ChartStyleì„ ë„£ì–´ì£¼ë©´ ëœë‹¤.

```kotlin
ProvideChartStyle(rememberChartStyle(...)) {
    CartesianChartHost(...)
}
```

## ì „ì²´ ì½”ë“œ

### LineChart.kt

```kotlin
private const val AXIS_VALUE_OVERRIDER_Y_FRACTION = 1f

private val axisValueOverrider =
    AxisValueOverrider.adaptiveYValues<LineCartesianLayerModel>(
        yFraction = AXIS_VALUE_OVERRIDER_Y_FRACTION,
        round = false,  // ë°˜ì˜¬ë¦¼
    )

@Composable
fun LineChart(viewModel: VicoViewModel = viewModel()) {
    val marker = rememberMarker()

    ProvideChartStyle(rememberChartStyle(chartColors = listOf(Color(0xFF007AFF)))) {
        CartesianChartHost(
            chart = rememberCartesianChart(
                rememberLineCartesianLayer(axisValueOverrider = axisValueOverrider),
                startAxis = rememberStartAxis(guideline = null),
                bottomAxis = rememberBottomAxis(
                    guideline = null,
                    itemPlacer = AxisItemPlacer.Horizontal.default(),
                ),
                persistentMarkers = remember(marker) { mapOf(2.0f to marker) },
                fadingEdges = rememberFadingEdges(),
                legend = rememberLegend()
            ),
            modelProducer = viewModel.getModelProducer(),
            marker = marker,
            isZoomEnabled = false,
            horizontalLayout = HorizontalLayout.fullWidth()

        )
    }
}
```

### ChartStyle.kt

```kotlin
@Composable
internal fun rememberChartStyle(
    columnLayerColors: List<Color>,
    lineLayerColors: List<Color>,
): ChartStyle {
    val isSystemInDarkTheme = isSystemInDarkTheme()
    return remember(columnLayerColors, lineLayerColors, isSystemInDarkTheme) {
        val defaultColors = if (isSystemInDarkTheme) DefaultColors.Dark else DefaultColors.Light
        ChartStyle(
            ChartStyle.Axis(
                axisLabelColor = Color(defaultColors.axisLabelColor),
                axisGuidelineColor = Color(defaultColors.axisGuidelineColor),
                axisLineColor = Color(defaultColors.axisLineColor),
            ),
            ChartStyle.ColumnLayer(
                columnLayerColors.map { columnChartColor ->
                    LineComponent(
                        columnChartColor.toArgb(),
                        DefaultDimens.COLUMN_WIDTH,
                        Shapes.roundedCornerShape(DefaultDimens.COLUMN_ROUNDNESS_PERCENT),
                    )
                },
            ),
            ChartStyle.LineLayer(
                lineLayerColors.map { lineChartColor ->
                    LineCartesianLayer.LineSpec(
                        shader = DynamicShaders.color(lineChartColor),
                        backgroundShader =
                        DynamicShaders.fromBrush(
                            Brush.verticalGradient(
                                listOf(
                                    lineChartColor.copy(DefaultAlpha.LINE_BACKGROUND_SHADER_START),
                                    lineChartColor.copy(DefaultAlpha.LINE_BACKGROUND_SHADER_END),
                                ),
                            ),
                        ),
                    )
                },
            ),
            ChartStyle.Marker(),
            Color(defaultColors.elevationOverlayColor),
        )
    }
}

@Composable
internal fun rememberChartStyle(chartColors: List<Color>) =
    rememberChartStyle(
        columnLayerColors = chartColors,
        lineLayerColors = chartColors
    )

```

### Legend.kt

```kotlin
private const val MAIN_COLOR = 0xFF007AFF

private val color1 = Color(MAIN_COLOR)
private val chartColors = listOf(color1)
private val legendItemLabelTextSize = 12.sp
private val legendItemIconSize = 8.dp
private val legendItemIconPaddingValue = 10.dp
private val legendItemSpacing = 4.dp
private val legendTopPaddingValue = 8.dp
private val legendPadding = dimensionsOf(top = legendTopPaddingValue)

@Composable
fun rememberLegend() =
    verticalLegend(
        items =
        chartColors.mapIndexed { _, chartColor ->
            legendItem(
                icon = rememberShapeComponent(Shapes.pillShape, chartColor),
                label =
                rememberTextComponent(
                    color = currentChartStyle.axis.axisLabelColor,
                    textSize = legendItemLabelTextSize,
                    typeface = Typeface.MONOSPACE,
                ),
                labelText = "12ì›”"
            )
        },
        iconSize = legendItemIconSize,
        iconPadding = legendItemIconPaddingValue,
        spacing = legendItemSpacing,
        padding = legendPadding,
    )
```

ì½”ë“œë¥¼ ë³´ê³  ëŒ€ë¶€ë¶„ ì´í•´ê°€ ê°€ëŠ¥í•˜ê² ì§€ë§Œ itemsì—ì„œ mapIndexed()ë¥¼ ì‚¬ìš©í•œ ì´ìœ ì— ëŒ€í•´ ì„¤ëª…í•´ë³´ë ¤ í•œë‹¤. `verticalLegend()` ì»´í¬ì €ë¸” í•¨ìˆ˜ì˜ items ë§¤ê°œë³€ìˆ˜ëŠ” **Collection** íƒ€ì…ì´ê¸° ë•Œë¬¸ì— listOf() ë¡œ ë¦¬ìŠ¤íŠ¸í™” í•´ì„œ ì ìš©í–ˆë‹¤.

### Marker.kt

[Market.kt](#marker)

### VicoViewModel.kt

[VicoViewModel.kt](#cartesianchartmodelproducer)

## References

[Vico ê³µì‹ í™ˆí˜ì´ì§€](https://patrykandpatrick.com/vico/wiki/2.0.0-alpha.6/)  
[Vico Git](https://github.com/patrykandpatrick/vico)

- ë²„ì „ì´ ì•½ê°„ ë‹¤ë¥¼ ìˆ˜ ìˆìœ¼ë‹ˆ ì°¸ê³ í•  ê²ƒ(VicoëŠ” ë²„ì „ë§ˆë‹¤ ì°¨ì´ê°€ í¬ë‹¤.)  
  [Vicoë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ComposedChart ë§Œë“¤ê¸°](https://rkdrkd-history.tistory.com/73)  
  [Chartë¥¼ Composeë¡œ êµ¬í˜„](https://rkdrkd-history.tistory.com/72)
